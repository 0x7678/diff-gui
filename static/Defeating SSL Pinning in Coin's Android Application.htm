<!DOCTYPE html>
<!-- saved from url=(0074)https://rotlogix.com/2015/09/13/defeating-ssl-pinning-in-coin-for-android/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <script async="" src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/analytics.js"></script><script>
        // UNCOMMENT AND USE YOUR VARIABLES FOR DISQUS AND GOOGLE ANALYTICS
        // var d_id  = '',
        //     g_id  = 'UA-XXXXXXXX-X', // Format: UA-########-#, Example: UA-11220899-1
        //     g_url = 'XXXXXXX.XXX' // Format: #####.####, Example: webdesignporto.com
    </script>

    <title>Defeating SSL Pinning in Coin's Android Application</title>
    <meta name="description" content="">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="./Defeating SSL Pinning in Coin&#39;s Android Application_files/prettify.css">
    <link rel="stylesheet" type="text/css" href="./Defeating SSL Pinning in Coin&#39;s Android Application_files/screen.css">

    <link rel="canonical" href="http://rotlogix.com/2015/09/13/defeating-ssl-pinning-in-coin-for-android/">
    <meta name="referrer" content="origin">
    
    <meta property="og:site_name" content="rotlogix">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Defeating SSL Pinning in Coin&#39;s Android Application">
    <meta property="og:description" content="Overview &quot;Coin is a connected device that holds and behaves like your cards with a magnetic stripe. Use the Coin mobile app to provide key information that we need in order to ship your Coin and to manage the original plastic cards (credit, debit, gift, membership, loyalty and more) that">
    <meta property="og:url" content="http://rotlogix.com/2015/09/13/defeating-ssl-pinning-in-coin-for-android/">
    <meta property="article:published_time" content="2015-09-13T18:23:34.000Z">
    <meta property="article:modified_time" content="2015-09-14T00:54:58.000Z">
    <meta property="article:tag" content="mobile security research">
    <meta property="article:tag" content="coin">
    <meta property="article:tag" content="android">
    <meta property="article:tag" content="ssl">
    <meta property="article:tag" content="pinning">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Defeating SSL Pinning in Coin&#39;s Android Application">
    <meta name="twitter:description" content="Overview &quot;Coin is a connected device that holds and behaves like your cards with a magnetic stripe. Use the Coin mobile app to provide key information that we need in order to ship your Coin and to manage the original plastic cards (credit, debit, gift, membership, loyalty and more) that">
    <meta name="twitter:url" content="http://rotlogix.com/2015/09/13/defeating-ssl-pinning-in-coin-for-android/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="rotlogix">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="mobile security research, coin, android, ssl, pinning">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "rotlogix",
        "logo": "http://rotlogix.com/content/images/2016/03/vape_profile.jpg"
    },
    "author": {
        "@type": "Person",
        "name": "rotlogix",
        "image": "http://rotlogix.com/content/images/2015/11/a8UOBijL_400x400.jpg",
        "url": "http://rotlogix.com/author/rotlogix/",
        "sameAs": [
            "http://rotlogix.com"
        ],
        "description": "I am currently pondering existentialism, structures, and instructions. Since boot, I&#x27;ve been constantly hacking, learning, and finding new ways to ruin my life with computers."
    },
    "headline": "Defeating SSL Pinning in Coin&#x27;s Android Application",
    "url": "https://rotlogix.com/2015/09/13/defeating-ssl-pinning-in-coin-for-android/",
    "datePublished": "2015-09-13T18:23:34.000Z",
    "dateModified": "2015-09-14T00:54:58.000Z",
    "keywords": "mobile security research, coin, android, ssl, pinning",
    "description": "Overview &quot;Coin is a connected device that holds and behaves like your cards with a magnetic stripe. Use the Coin mobile app to provide key information that we need in order to ship your Coin and to manage the original plastic cards (credit, debit, gift, membership, loyalty and more) that"
}
    </script>

    <meta name="generator" content="Ghost 0.8">
    <link rel="alternate" type="application/rss+xml" title="rotlogix" href="https://rotlogix.com/rss/">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', g_id, g_url);
      ga('send', 'pageview');

    </script>
</head>
<body class="post-template tag-mobile-security-researche tag-coin tag-android tag-ssl tag-pinning">

    

<main class="content" role="main">

    <article class="post tag-mobile-security-researche tag-coin tag-android tag-ssl tag-pinning">

        <header class="post-header">
            <a id="blog-logo" href="http://rotlogix.com/">
                    <img src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/vape_profile.jpg" alt="Blog Logo">
            </a>
        </header>


        <span class="post-meta"><time datetime="2015-09-13">13 Sep 2015</time> on <a href="https://rotlogix.com/tag/mobile-security-researche/">mobile security research</a> | <a href="https://rotlogix.com/tag/coin/">coin</a> | <a href="https://rotlogix.com/tag/android/">android</a> | <a href="https://rotlogix.com/tag/ssl/">ssl</a> | <a href="https://rotlogix.com/tag/pinning/">pinning</a></span>

        <h1 class="post-title">Defeating SSL Pinning in Coin's Android Application</h1>

        <section class="post-content">
            <hr>

<h1 id="overview">Overview</h1>

<p><em>"Coin is a connected device that holds and behaves like your cards with a magnetic stripe.
Use the Coin mobile app to provide key information that we need in order to ship your Coin and to manage the original plastic cards (credit, debit, gift, membership, loyalty and more) that you use with the Coin device."</em></p>

<p>This weekend my buddy <a href="https://twitter.com/_lavalamp">@_lavalamp</a> and I decided to take a look at his <a href="https://onlycoin.com/">Coin</a> device and its accompanied Android <a href="https://play.google.com/store/apps/details?id=com.onlycoin.android">application</a>.  The device and the application have an interesting attack surface, which we are still researching, so expect more updates from both of us to follow.  In this post we are going to cover how the Coin Android application implements SSL pinning, and the techniques we used to defeat it.</p>

<h2 id="recon">Recon</h2>

<p>When decompiling the application the first thing we noticed were a handful of Bouncy Castle key stores located within the assets directory.</p>

<pre class="prettyprint prettyprinted"><code><span class="pun">[~</span><span class="str">/Downloads/</span><span class="pln">com</span><span class="pun">.</span><span class="pln">onlycoin</span><span class="pun">.</span><span class="pln">android</span><span class="pun">-</span><span class="lit">1</span><span class="pun">/</span><span class="pln">assets</span><span class="pun">]&gt;</span><span class="pln"> ls
ble_config</span><span class="pun">.</span><span class="pln">json      coincert_new</span><span class="pun">.</span><span class="pln">bks     ocra</span><span class="pun">.</span><span class="pln">otf             segment14</span><span class="pun">.</span><span class="pln">otf        zxcvbn</span><span class="pun">.</span><span class="pln">html  
coincert</span><span class="pun">.</span><span class="pln">bks         coincert_staging</span><span class="pun">.</span><span class="pln">bks rewards</span><span class="pun">.</span><span class="pln">json         zxcvbn</span><span class="pun">-</span><span class="pln">async</span><span class="pun">.</span><span class="pln">js      zxcvbn</span><span class="pun">.</span><span class="pln">js  </span></code></pre>

<p>There was already an assumption the application was probably going to be using a lot of crypto, and rightfully so, considering its sole purpose.</p>

<p>After installing the application, we immediately wanted to start proxying all outbound HTTP and HTTPS, so we setup a global proxy and attempted to log into the application.  We were greeted with the following error.</p>

<p><img src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/screen-1.png" alt="error"></p>

<p>They appeared to have implemented SSL pinning in their application, which was pretty obvious to be the source of this error.</p>

<h2 id="deepdive">Deep Dive</h2>

<p>We needed to defeat this protection mechanism, in order to start understanding how the application was interacting with any api endpoints. It did not take very long to pin point where the SSL Pinning functionality was being implemented.</p>

<p>We found in the class <code>com.onlycoin.android.secure.SSLPinning</code> a static method that would return an SSLSocketFactory.</p>

<p><img src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/ssl.png" alt="ssl"></p>

<p>This would simply open a Bouncy Castle key store, load up all of the stored certificates and validate them with the methods <code>checkClientTrusted</code> and <code>checkServerTrusted</code> within the <code>CompositeX509TrustManager</code> class.  If the certificate was not inside of the Bouncy Castle key store, the corresponding methods would throw an exception with an error message that gets displayed back in the application's UI.</p>

<p>We spent quite bit of time trying to figure out how to actually patch out this implementation in order to achieve a bypass, but realized it would be more efficient to use instrumentation instead.</p>

<h2 id="instrumentation">Instrumentation</h2>

<p>We were able to craft a <a href="http://www.frida.re/">Frida</a> script that allowed us to hook the method that returned the SSLSocketFactory, and then proceeded working through ideas on how to actually modify the overall control flow, until <a href="https://twitter.com/_lavalamp">@_lavalamp</a> had the genius idea of just returning the arguments being passed to the method.  This would actually give us the password and the name to the Bouncy Castle key store being used.</p>

<p><strong>PoC</strong></p>

<pre class="prettyprint prettyprinted"><code><span class="com"># Written by rotlogix &amp; lavalamp</span><span class="pln">
</span><span class="com"># </span><span class="pln">
</span><span class="com">#</span><span class="pln">
</span><span class="kwd">import</span><span class="pln"> frida  
</span><span class="kwd">import</span><span class="pln"> sys  
</span><span class="kwd">from</span><span class="pln"> subprocess </span><span class="kwd">import</span><span class="pln"> </span><span class="typ">Popen</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> on_message</span><span class="pun">(</span><span class="pln">message</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">):</span><span class="pln">  
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> message</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"[*] {0}"</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="pln">message</span><span class="pun">[</span><span class="str">"payload"</span><span class="pun">]))</span><span class="pln">
    </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">Exception</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> e</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">message</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> do_ssl</span><span class="pun">():</span><span class="pln">

    ssl </span><span class="pun">=</span><span class="pln"> </span><span class="str">"""

        Dalvik.perform(function () {

                var SSLPinning = Dalvik.use("</span><span class="pln">com</span><span class="pun">.</span><span class="pln">onlycoin</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">secure</span><span class="pun">.</span><span class="typ">SSLPinning</span><span class="str">");

                    SSLPinning.a.overload("</span><span class="pln">android</span><span class="pun">.</span><span class="pln">content</span><span class="pun">.</span><span class="typ">Context</span><span class="str">", "</span><span class="pun">[</span><span class="typ">Ljava</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">.</span><span class="typ">String</span><span class="pun">;</span><span class="str">", "</span><span class="pln">java</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">.</span><span class="typ">String</span><span class="str">").implementation = function (c, s, ss) {

                        send("</span><span class="typ">SSLPinning</span><span class="str">");
                        send(c.toString());
                        send(s.toString());
                        send(ss.toString());
                        this.a.overload("</span><span class="pln">android</span><span class="pun">.</span><span class="pln">content</span><span class="pun">.</span><span class="typ">Context</span><span class="str">", "</span><span class="pun">[</span><span class="typ">Ljava</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">.</span><span class="typ">String</span><span class="pun">;</span><span class="str">", "</span><span class="pln">java</span><span class="pun">.</span><span class="pln">lang</span><span class="pun">.</span><span class="typ">String</span><span class="str">").call(this, c, s, ss);


                    };

                });

    """</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ssl

</span><span class="kwd">if</span><span class="pln"> __name__ </span><span class="pun">==</span><span class="pln"> </span><span class="str">"__main__"</span><span class="pun">:</span><span class="pln">  
    </span><span class="kwd">try</span><span class="pun">:</span><span class="pln">
         </span><span class="typ">Popen</span><span class="pun">([</span><span class="str">"adb forward tcp:27042 tcp:27042"</span><span class="pun">],</span><span class="pln"> shell</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">).</span><span class="pln">wait</span><span class="pun">()</span><span class="pln">
         process </span><span class="pun">=</span><span class="pln"> frida</span><span class="pun">.</span><span class="pln">get_device_manager</span><span class="pun">().</span><span class="pln">enumerate_devices</span><span class="pun">()[-</span><span class="lit">1</span><span class="pun">].</span><span class="pln">attach</span><span class="pun">(</span><span class="str">"com.onlycoin.android"</span><span class="pun">)</span><span class="pln">
         script </span><span class="pun">=</span><span class="pln"> process</span><span class="pun">.</span><span class="pln">create_script</span><span class="pun">(</span><span class="pln">do_ssl</span><span class="pun">())</span><span class="pln">
         script</span><span class="pun">.</span><span class="pln">on</span><span class="pun">(</span><span class="str">'message'</span><span class="pun">,</span><span class="pln"> on_message</span><span class="pun">)</span><span class="pln">
         script</span><span class="pun">.</span><span class="pln">load</span><span class="pun">()</span><span class="pln">
         sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">read</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">except</span><span class="pln"> </span><span class="typ">KeyboardInterrupt</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> e</span><span class="pun">:</span><span class="pln">
        sys</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span></code></pre>

<p>We set our script in motion and ...</p>

<pre class="prettyprint prettyprinted"><code><span class="pun">[~</span><span class="str">/Tools/</span><span class="pln">mobile</span><span class="pun">/</span><span class="pln">android</span><span class="pun">/</span><span class="pln">frida</span><span class="pun">]&gt;</span><span class="pln"> python onlycoin</span><span class="pun">.</span><span class="pln">py
</span><span class="pun">[*]</span><span class="pln"> </span><span class="typ">SSLPinning</span><span class="pln">
</span><span class="pun">[*]</span><span class="pln"> </span><span class="pln">com</span><span class="pun">.</span><span class="pln">onlycoin</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="typ">CoinApplication@4281e998</span><span class="pln">
</span><span class="pun">[*]</span><span class="pln"> coincert</span><span class="pun">.</span><span class="pln">bks</span><span class="pun">,</span><span class="pln">coincert_new</span><span class="pun">.</span><span class="pln">bks
</span><span class="pun">[*]</span><span class="pln"> laggardness287</span><span class="pun">{</span><span class="pln">satisfactoriness</span></code></pre>

<p>Excellent! Now we had the name of the key store and the password.  We could now take our Burpsuite exported certificated and add it to this key store, which would be loaded at runtime and added as a trusted certificate.</p>

<h2 id="bypass">Bypass</h2>

<p>First we added our Burpsuite certificate to the <code>coincert.bks</code> key store.</p>

<pre class="prettyprint prettyprinted"><code><span class="pln">keytool </span><span class="pun">-</span><span class="pln">importcert </span><span class="pun">-</span><span class="pln">v </span><span class="pun">-</span><span class="pln">trustcacerts </span><span class="pun">-</span><span class="pln">file </span><span class="pun">/</span><span class="typ">Users</span><span class="pun">/</span><span class="pln">benjaminwatson</span><span class="pun">/</span><span class="typ">Tools</span><span class="pun">/</span><span class="pln">web</span><span class="pun">/</span><span class="pln">burp</span><span class="pun">/</span><span class="pln">burp</span><span class="pun">.</span><span class="pln">cer </span><span class="pun">-</span><span class="pln">providerpath </span><span class="pun">/</span><span class="typ">Users</span><span class="pun">/</span><span class="pln">benjaminwatson</span><span class="pun">/</span><span class="typ">Downloads</span><span class="pun">/</span><span class="pln">bcprov</span><span class="pun">-</span><span class="pln">jdk15on</span><span class="pun">-</span><span class="lit">152.jar</span><span class="pln"> </span><span class="pun">-</span><span class="pln">provider org</span><span class="pun">.</span><span class="pln">bouncycastle</span><span class="pun">.</span><span class="pln">jce</span><span class="pun">.</span><span class="pln">provider</span><span class="pun">.</span><span class="typ">BouncyCastleProvider</span><span class="pln"> </span><span class="pun">-</span><span class="pln">storetype BKS </span><span class="pun">-</span><span class="pln">keystore </span><span class="pun">~</span><span class="str">/Downloads/</span><span class="pln">com</span><span class="pun">.</span><span class="pln">onlycoin</span><span class="pun">.</span><span class="pln">android</span><span class="pun">-</span><span class="lit">1</span><span class="pun">/</span><span class="pln">assets</span><span class="pun">/</span><span class="pln">coincert</span><span class="pun">.</span><span class="pln">bks  </span></code></pre>

<pre class="prettyprint prettyprinted"><code><span class="pun">[~]&gt;</span><span class="pln"> keytool </span><span class="pun">-</span><span class="pln">list </span><span class="pun">-</span><span class="pln">v </span><span class="pun">-</span><span class="pln">providerpath </span><span class="pun">/</span><span class="typ">Users</span><span class="pun">/</span><span class="pln">benjaminwatson</span><span class="pun">/</span><span class="typ">Downloads</span><span class="pun">/</span><span class="pln">bcprov</span><span class="pun">-</span><span class="pln">jdk15on</span><span class="pun">-</span><span class="lit">152.jar</span><span class="pln"> </span><span class="pun">-</span><span class="pln">provider org</span><span class="pun">.</span><span class="pln">bouncycastle</span><span class="pun">.</span><span class="pln">jce</span><span class="pun">.</span><span class="pln">provider</span><span class="pun">.</span><span class="typ">BouncyCastleProvider</span><span class="pln"> </span><span class="pun">-</span><span class="pln">storetype BKS </span><span class="pun">-</span><span class="pln">keystore </span><span class="pun">~</span><span class="str">/Downloads/</span><span class="pln">com</span><span class="pun">.</span><span class="pln">onlycoin</span><span class="pun">.</span><span class="pln">android</span><span class="pun">-</span><span class="lit">1</span><span class="pun">/</span><span class="pln">assets</span><span class="pun">/</span><span class="pln">coincert</span><span class="pun">.</span><span class="pln">bks
</span><span class="typ">Enter</span><span class="pln"> keystore password</span><span class="pun">:</span><span class="pln">

</span><span class="typ">Keystore</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> BKS  
</span><span class="typ">Keystore</span><span class="pln"> provider</span><span class="pun">:</span><span class="pln"> BC

</span><span class="typ">Your</span><span class="pln"> keystore contains </span><span class="lit">2</span><span class="pln"> entries

</span><span class="typ">Alias</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> ca  
</span><span class="typ">Creation</span><span class="pln"> date</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Mar</span><span class="pln"> </span><span class="lit">19</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2015</span><span class="pln">  
</span><span class="typ">Entry</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> trustedCertEntry

</span><span class="typ">Owner</span><span class="pun">:</span><span class="pln"> OU</span><span class="pun">=</span><span class="typ">Domain</span><span class="pln"> </span><span class="typ">Control</span><span class="pln"> </span><span class="typ">Validated</span><span class="pun">,</span><span class="pln">OU</span><span class="pun">=</span><span class="pln">COMODO SSL </span><span class="typ">Wildcard</span><span class="pun">,</span><span class="pln">CN</span><span class="pun">=*.</span><span class="pln">coin</span><span class="pun">.</span><span class="pln">vc  
</span><span class="typ">Issuer</span><span class="pun">:</span><span class="pln"> C</span><span class="pun">=</span><span class="pln">GB</span><span class="pun">,</span><span class="pln">ST</span><span class="pun">=</span><span class="typ">Greater</span><span class="pln"> </span><span class="typ">Manchester</span><span class="pun">,</span><span class="pln">L</span><span class="pun">=</span><span class="typ">Salford</span><span class="pun">,</span><span class="pln">O</span><span class="pun">=</span><span class="pln">COMODO CA </span><span class="typ">Limited</span><span class="pun">,</span><span class="pln">CN</span><span class="pun">=</span><span class="pln">COMODO SSL CA  
</span><span class="typ">Serial</span><span class="pln"> number</span><span class="pun">:</span><span class="pln"> e9f4e34ca8a073842a7c144bdc176796  
</span><span class="typ">Valid</span><span class="pln"> </span><span class="kwd">from</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Tue</span><span class="pln"> </span><span class="typ">Apr</span><span class="pln"> </span><span class="lit">08</span><span class="pln"> </span><span class="lit">20</span><span class="pun">:</span><span class="lit">00</span><span class="pun">:</span><span class="lit">00</span><span class="pln"> EDT </span><span class="lit">2014</span><span class="pln"> </span><span class="kwd">until</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Thu</span><span class="pln"> </span><span class="typ">Apr</span><span class="pln"> </span><span class="lit">09</span><span class="pln"> </span><span class="lit">19</span><span class="pun">:</span><span class="lit">59</span><span class="pun">:</span><span class="lit">59</span><span class="pln"> EDT </span><span class="lit">2015</span><span class="pln">  
</span><span class="typ">Certificate</span><span class="pln"> fingerprints</span><span class="pun">:</span><span class="pln">  
     MD5</span><span class="pun">:</span><span class="pln">  </span><span class="lit">72</span><span class="pun">:</span><span class="pln">FA</span><span class="pun">:</span><span class="lit">98</span><span class="pun">:</span><span class="pln">D3</span><span class="pun">:</span><span class="lit">31</span><span class="pun">:</span><span class="pln">F3</span><span class="pun">:</span><span class="lit">6A</span><span class="pun">:</span><span class="lit">60</span><span class="pun">:</span><span class="pln">A8</span><span class="pun">:</span><span class="pln">A0</span><span class="pun">:</span><span class="lit">31</span><span class="pun">:</span><span class="lit">87</span><span class="pun">:</span><span class="pln">B5</span><span class="pun">:</span><span class="lit">42</span><span class="pun">:</span><span class="lit">17</span><span class="pun">:</span><span class="lit">84</span><span class="pln">
     SHA1</span><span class="pun">:</span><span class="pln"> E7</span><span class="pun">:</span><span class="pln">A2</span><span class="pun">:</span><span class="lit">41</span><span class="pun">:</span><span class="pln">B6</span><span class="pun">:</span><span class="lit">30</span><span class="pun">:</span><span class="lit">7D</span><span class="pun">:</span><span class="lit">06</span><span class="pun">:</span><span class="lit">6F</span><span class="pun">:</span><span class="lit">39</span><span class="pun">:</span><span class="lit">16</span><span class="pun">:</span><span class="lit">86</span><span class="pun">:</span><span class="lit">0C</span><span class="pun">:</span><span class="pln">F0</span><span class="pun">:</span><span class="pln">FC</span><span class="pun">:</span><span class="pln">A3</span><span class="pun">:</span><span class="lit">19</span><span class="pun">:</span><span class="pln">FD</span><span class="pun">:</span><span class="lit">69</span><span class="pun">:</span><span class="pln">A1</span><span class="pun">:</span><span class="lit">5B</span><span class="pln">
     SHA256</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4E</span><span class="pun">:</span><span class="lit">9C</span><span class="pun">:</span><span class="lit">3B</span><span class="pun">:</span><span class="lit">52</span><span class="pun">:</span><span class="lit">84</span><span class="pun">:</span><span class="pln">AA</span><span class="pun">:</span><span class="pln">D8</span><span class="pun">:</span><span class="lit">5A</span><span class="pun">:</span><span class="lit">55</span><span class="pun">:</span><span class="pln">DA</span><span class="pun">:</span><span class="pln">AB</span><span class="pun">:</span><span class="pln">DE</span><span class="pun">:</span><span class="pln">B9</span><span class="pun">:</span><span class="lit">3F</span><span class="pun">:</span><span class="lit">5A</span><span class="pun">:</span><span class="pln">D6</span><span class="pun">:</span><span class="lit">29</span><span class="pun">:</span><span class="lit">1A</span><span class="pun">:</span><span class="lit">90</span><span class="pun">:</span><span class="lit">2A</span><span class="pun">:</span><span class="lit">63</span><span class="pun">:</span><span class="pln">CE</span><span class="pun">:</span><span class="pln">A5</span><span class="pun">:</span><span class="lit">0D</span><span class="pun">:</span><span class="lit">65</span><span class="pun">:</span><span class="pln">D4</span><span class="pun">:</span><span class="pln">DE</span><span class="pun">:</span><span class="lit">36</span><span class="pun">:</span><span class="lit">99</span><span class="pun">:</span><span class="pln">E7</span><span class="pun">:</span><span class="pln">EB</span><span class="pun">:</span><span class="lit">0F</span><span class="pln">
     </span><span class="typ">Signature</span><span class="pln"> algorithm name</span><span class="pun">:</span><span class="pln"> SHA1WITHRSA
     </span><span class="typ">Version</span><span class="pun">:</span><span class="pln"> </span><span class="lit">3</span><span class="pln">


</span><span class="pun">*******************************************</span><span class="pln">
</span><span class="pun">*******************************************</span><span class="pln">


</span><span class="typ">Alias</span><span class="pln"> name</span><span class="pun">:</span><span class="pln"> mykey  
</span><span class="typ">Creation</span><span class="pln"> date</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Sep</span><span class="pln"> </span><span class="lit">12</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2015</span><span class="pln">  
</span><span class="typ">Entry</span><span class="pln"> type</span><span class="pun">:</span><span class="pln"> trustedCertEntry

</span><span class="typ">Owner</span><span class="pun">:</span><span class="pln"> C</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">ST</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">L</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">O</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">OU</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pln"> CA</span><span class="pun">,</span><span class="pln">CN</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pln"> CA  
</span><span class="typ">Issuer</span><span class="pun">:</span><span class="pln"> C</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">ST</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">L</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">O</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pun">,</span><span class="pln">OU</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pln"> CA</span><span class="pun">,</span><span class="pln">CN</span><span class="pun">=</span><span class="typ">PortSwigger</span><span class="pln"> CA  
</span><span class="typ">Serial</span><span class="pln"> number</span><span class="pun">:</span><span class="pln"> </span><span class="lit">55c1130b</span><span class="pln">  
</span><span class="typ">Valid</span><span class="pln"> </span><span class="kwd">from</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Tue</span><span class="pln"> </span><span class="typ">Aug</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> </span><span class="lit">15</span><span class="pun">:</span><span class="lit">31</span><span class="pun">:</span><span class="lit">23</span><span class="pln"> EDT </span><span class="lit">2015</span><span class="pln"> </span><span class="kwd">until</span><span class="pun">:</span><span class="pln"> </span><span class="typ">Mon</span><span class="pln"> </span><span class="typ">Jul</span><span class="pln"> </span><span class="lit">30</span><span class="pln"> </span><span class="lit">15</span><span class="pun">:</span><span class="lit">31</span><span class="pun">:</span><span class="lit">23</span><span class="pln"> EDT </span><span class="lit">2035</span><span class="pln">  
</span><span class="typ">Certificate</span><span class="pln"> fingerprints</span><span class="pun">:</span><span class="pln">  
     MD5</span><span class="pun">:</span><span class="pln">  F1</span><span class="pun">:</span><span class="pln">BD</span><span class="pun">:</span><span class="lit">1A</span><span class="pun">:</span><span class="pln">DA</span><span class="pun">:</span><span class="pln">E1</span><span class="pun">:</span><span class="lit">1B</span><span class="pun">:</span><span class="pln">D3</span><span class="pun">:</span><span class="lit">92</span><span class="pun">:</span><span class="lit">69</span><span class="pun">:</span><span class="lit">7A</span><span class="pun">:</span><span class="lit">9B</span><span class="pun">:</span><span class="lit">02</span><span class="pun">:</span><span class="lit">01</span><span class="pun">:</span><span class="lit">31</span><span class="pun">:</span><span class="lit">4A</span><span class="pun">:</span><span class="lit">8F</span><span class="pln">
     SHA1</span><span class="pun">:</span><span class="pln"> EE</span><span class="pun">:</span><span class="pln">BA</span><span class="pun">:</span><span class="lit">11</span><span class="pun">:</span><span class="lit">91</span><span class="pun">:</span><span class="pln">D8</span><span class="pun">:</span><span class="lit">6B</span><span class="pun">:</span><span class="pln">FA</span><span class="pun">:</span><span class="pln">A5</span><span class="pun">:</span><span class="lit">26</span><span class="pun">:</span><span class="lit">2C</span><span class="pun">:</span><span class="lit">4C</span><span class="pun">:</span><span class="lit">60</span><span class="pun">:</span><span class="lit">55</span><span class="pun">:</span><span class="pln">AB</span><span class="pun">:</span><span class="lit">05</span><span class="pun">:</span><span class="lit">61</span><span class="pun">:</span><span class="pln">F7</span><span class="pun">:</span><span class="pln">F3</span><span class="pun">:</span><span class="lit">67</span><span class="pun">:</span><span class="lit">79</span><span class="pln">
     SHA256</span><span class="pun">:</span><span class="pln"> </span><span class="lit">97</span><span class="pun">:</span><span class="pln">AC</span><span class="pun">:</span><span class="lit">9F</span><span class="pun">:</span><span class="lit">7E</span><span class="pun">:</span><span class="lit">1B</span><span class="pun">:</span><span class="pln">BE</span><span class="pun">:</span><span class="lit">38</span><span class="pun">:</span><span class="pln">D8</span><span class="pun">:</span><span class="lit">3D</span><span class="pun">:</span><span class="pln">ED</span><span class="pun">:</span><span class="lit">4D</span><span class="pun">:</span><span class="pln">ED</span><span class="pun">:</span><span class="lit">85</span><span class="pun">:</span><span class="pln">D9</span><span class="pun">:</span><span class="lit">95</span><span class="pun">:</span><span class="pln">C7</span><span class="pun">:</span><span class="lit">87</span><span class="pun">:</span><span class="lit">41</span><span class="pun">:</span><span class="pln">D5</span><span class="pun">:</span><span class="pln">BC</span><span class="pun">:</span><span class="pln">F0</span><span class="pun">:</span><span class="lit">04</span><span class="pun">:</span><span class="pln">AE</span><span class="pun">:</span><span class="lit">43</span><span class="pun">:</span><span class="lit">38</span><span class="pun">:</span><span class="pln">D3</span><span class="pun">:</span><span class="pln">E3</span><span class="pun">:</span><span class="lit">7D</span><span class="pun">:</span><span class="lit">68</span><span class="pun">:</span><span class="lit">8E</span><span class="pun">:</span><span class="lit">13</span><span class="pun">:</span><span class="lit">13</span><span class="pln">
     </span><span class="typ">Signature</span><span class="pln"> algorithm name</span><span class="pun">:</span><span class="pln"> SHA256WITHRSA
     </span><span class="typ">Version</span><span class="pun">:</span><span class="pln"> </span><span class="lit">3</span><span class="pln">


</span><span class="pun">*******************************************</span><span class="pln">
</span><span class="pun">*******************************************</span></code></pre>

<p>We then rebuilt the Coin application and deployed it back to device.  <em>Now for the moment of truth ..</em></p>

<p><img src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/bypass-1.png" alt="bypass"></p>

<p>Success!  We had defeated the application's SSL Pinning.</p>

<h2 id="conclusion">Conclusion</h2>

<p>SSL Pinning provides some level of security for any mobile application, but should not be solely relied upon, and often can be easily defeated.</p>

<p><strong><em>Update</em></strong></p>

<p>Apparently I wasn't explicit enough for the Internet in my conclusion.  The application's SSL Pinning implementation is spot on and there is nothing wrong with it.  This post is merely teaching different techniques you can use to reverse engineer and "defeat" said implementation, which allows you to perform things like proxying HTTPS traffic.</p>
        </section>

        <footer class="post-footer">

                <section class="author">
                    <h4>rotlogix</h4>
                    <p>I am currently pondering existentialism, structures, and instructions. Since boot, I've been constantly hacking, learning, and finding new ways to ruin my life with computers.</p>
                </section>

            <section class="share">
                <h4>Share this</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Defeating%20SSL%20Pinning%20in%20Coin%27s%20Android%20Application&amp;url=https://rotlogix.com/2015/09/13/defeating-ssl-pinning-in-coin-for-android/" onclick="window.open(this.href, &#39;twitter-share&#39;, &#39;width=550,height=235&#39;);return false;">
                    <span class="hidden">Twitter</span>
                </a>
            </section>

        </footer>


    </article>

</main>


    <footer class="site-footer">
        <!-- <a class="subscribe icon-feed" href="http://rotlogix.com/rss/"><span class="tooltip">Subscribe!</span></a> -->
        <div class="inner">
             <section class="copyright">All content copyright <a href="https://rotlogix.com/">rotlogix</a> © 2016 • All rights reserved.</section>
        </div>
    </footer>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/jquery-1.11.3.min.js"></script>

    <script type="text/javascript" src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/prettify.js"></script>
    <script type="text/javascript" src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/shell.js"></script>
<img src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/view.gif" alt="" style="display:none" hidden="">


<iframe id="rdbIndicator" width="100%" height="270" border="0" src="./Defeating SSL Pinning in Coin&#39;s Android Application_files/indicator.html" style="display: none; border: 0; position: fixed; left: 0; top: 0; z-index: 2147483647"></iframe></body></html>